class Romaji

  def self.to_kana text
    # Logically it was important for me to check the order of the replacements.
    # Basically, make sure the pattern I'm replacing now, isn't a subpattern of
    # a future pattern.  In other words, make sure this pattern doesn't clash
    # with a future pattern.
    mapping = {
       'bb' =>    'っb',  'cc' =>    'っc',  'dd' =>    'っd',  'ff' =>    'っf',  'gg' =>    'っg',
       'hh' =>    'っh',  'jj' =>    'っj',  'kk' =>    'っk',  'll' =>    'っl',  'mm' =>    'っm',
       'pp' =>    'っp',  'rr' =>    'っr',  'ss' =>    'っs',  'tt' =>    'っt',
       'vv' =>    'っv',  'ww' =>    'っw',  'yy' =>    'っy',  'zz' =>    'っz',
      'wha' =>   'うぁ', 'whi' =>   'うぃ', 'whu' =>   'うぅ', 'whe' =>   'うぇ', 'who' =>   'うぉ',
      'kya' =>   'きゃ', 'kyi' =>   'きぃ', 'kyu' =>   'きゅ', 'kye' =>   'きぇ', 'kyo' =>   'きょ',
       'ka' =>     'か',  'ki' =>     'き',  'ku' =>     'く',  'ke' =>     'け',  'ko' =>     'こ',
      'gya' =>   'ぎゃ', 'gyi' =>   'ぎぃ', 'gyu' =>   'ぎゅ', 'gye' =>   'ぎぇ', 'gyo' =>   'ぎょ',
       'ga' =>     'が',  'gi' =>     'ぎ',  'gu' =>     'ぐ',  'ge' =>     'げ',  'go' =>     'ご',
      'sha' =>   'しゃ', 'shi' =>     'し', 'shu' =>   'しゅ', 'she' =>   'しぇ', 'sho' =>   'しょ',
      'sya' =>   'しゃ', 'syi' =>   'しぃ', 'syu' =>   'しゅ', 'sye' =>   'しぇ', 'syo' =>   'しょ',
      'swa' =>   'すぁ', 'swi' =>   'すぃ', 'swu' =>   'すぅ', 'swe' =>   'すぇ', 'swo' =>   'すぉ',
                          'ci' =>     'し',
      'zya' =>   'じゃ', 'zyi' =>   'じぃ', 'zyu' =>   'じゅ', 'zye' =>   'じぇ', 'zyo' =>   'じょ',
      'jya' =>   'じゃ', 'jyi' =>   'じぃ', 'jyu' =>   'じゅ', 'jye' =>   'じぇ', 'jyo' =>   'じょ',
       'ja' =>   'じゃ',  'ji' =>     'じ',  'ju' =>   'じゅ',  'je' =>   'じぇ',  'jo' =>   'じょ',
                         'dzi' =>     'ぢ',
       'za' =>     'ざ',  'zi' =>     'じ',  'zu' =>     'ず',  'ze' =>     'ぜ',  'zo' =>     'ぞ',
      'zha' =>   'じゃ', 'zhi' =>   'じぃ', 'zhu' =>   'じゅ', 'zhe' =>   'じぇ', 'zho' =>   'じょ',
      'cha' =>   'ちゃ', 'chi' =>     'ち', 'chu' =>   'ちゅ', 'che' =>   'ちぇ', 'cho' =>   'ちょ',
      'tya' =>   'ちゃ', 'tyi' =>   'ちぃ', 'tyu' =>   'ちゅ', 'tye' =>   'ちぇ', 'tyo' =>   'ちょ',
      'cya' =>   'ちゃ', 'cyi' =>   'ちぃ', 'cyu' =>   'ちゅ', 'cye' =>   'ちぇ', 'cyo' =>   'ちょ',
      'tsa' =>   'つゃ', 'tsi' =>   'つぃ', 'tsu' =>     'つ', 'tse' =>   'つぇ', 'tso' =>   'つょ',
      'tha' =>   'てゃ', 'thi' =>   'てぃ', 'thu' =>   'てゅ', 'the' =>   'てぇ', 'tho' =>   'てょ',
      'twa' =>   'とぁ', 'twi' =>   'とぃ', 'twu' =>   'とぅ', 'twe' =>   'とぇ', 'two' =>   'とぉ',
       'ta' =>     'た',  'ti' =>     'ち',  'tu' =>     'つ',  'te' =>     'て',  'to' =>     'と',
      'dya' =>   'ぢゃ', 'dyi' =>   'ぢぃ', 'dyu' =>   'ぢゅ', 'dye' =>   'ぢぇ', 'dyo' =>   'ぢょ',
      'dha' =>   'でゃ', 'dhi' =>   'でぃ', 'dhu' =>   'でゅ', 'dhe' =>   'でぇ', 'dho' =>   'でょ',
      'dwa' =>   'どぁ', 'dwi' =>   'どぃ', 'dwu' =>   'どぅ', 'dwe' =>   'どぇ', 'dwo' =>   'どぉ',
       'da' =>     'だ',  'di' =>     'ぢ',  'du' =>     'づ',  'de' =>     'で',  'do' =>     'ど',
       'na' =>     'な',  'ni' =>     'に',  'nu' =>     'ぬ',  'ne' =>     'ね',  'no' =>     'の',
      'nya' =>   'にゃ', 'nyi' =>   'にぃ', 'nyu' =>   'にゅ', 'nye' =>   'にぇ', 'nyo' =>   'にょ',
      'hya' =>   'ひゃ', 'hyi' =>   'ひぃ', 'hyu' =>   'ひゅ', 'hye' =>   'ひぇ', 'hyo' =>   'ひょ',
       'ha' =>     'は',  'hi' =>     'ひ',  'hu' =>     'ふ',  'he' =>     'へ',  'ho' =>     'ほ',
      'fya' =>   'ふゃ', 'fyi' =>   'ふぃ', 'fyu' =>   'ふゅ', 'fye' =>   'ふぇ', 'fyo' =>   'ふょ',
      'fwa' =>   'ふぁ', 'fwi' =>   'ふぃ', 'fwu' =>   'ふぅ', 'fwe' =>   'ふぇ', 'fwo' =>   'ふぉ',
       'fa' =>   'ふぁ',  'fi' =>   'ふぃ',  'fu' =>     'ふ',  'fe' =>   'ふぇ',  'fo' =>   'ふぉ',
      'bya' =>   'びゃ', 'byi' =>   'びぃ', 'byu' =>   'びゅ', 'bye' =>   'びぇ', 'byo' =>   'びょ',
       'ba' =>     'ば',  'bi' =>     'び',  'bu' =>     'ぶ',  'be' =>     'べ',  'bo' =>     'ぼ',
      'vya' =>   'ゔゃ', 'vyi' =>   'ゔぃ', 'vyu' =>   'ゔゅ', 'vye' =>   'ゔぇ', 'vyo' =>   'ゔょ',
       'va' =>   'ゔぁ',  'vi' =>   'ゔぃ',  'vu' =>     'ゔ',  've' =>   'ゔぇ',  'vo' =>   'ゔぉ',
      'pya' =>   'ぴゃ', 'pyi' =>   'ぴぃ', 'pyu' =>   'ぴゅ', 'pye' =>   'ぴぇ', 'pyo' =>   'ぴょ',
       'pa' =>     'ぱ',  'pi' =>     'ぴ',  'pu' =>     'ぷ',  'pe' =>     'ぺ',  'po' =>     'ぽ',
      'mya' =>   'みゃ', 'myi' =>   'みぃ', 'myu' =>   'みゅ', 'mye' =>   'みぇ', 'myo' =>   'みょ',
       'ma' =>     'ま',  'mi' =>     'み',  'mu' =>     'む',  'me' =>     'め',  'mo' =>     'も',
      'rya' =>   'りゃ', 'ryi' =>   'りぃ', 'ryu' =>   'りゅ', 'rye' =>   'りぇ', 'ryo' =>   'りょ',
      'lya' =>   'りゃ', 'lyi' =>   'りぃ', 'lyu' =>   'りゅ', 'lye' =>   'りぇ', 'lyo' =>   'りょ',
       'ra' =>     'ら',  'ri' =>     'り',  'ru' =>     'る',  're' =>     'れ',  'ro' =>     'ろ',
       'la' =>     'ら',  'li' =>     'り',  'lu' =>     'る',  'le' =>     'れ',  'lo' =>     'ろ',
       'wa' =>     'わ',  'wi' =>   'うぃ',                     'we' =>   'うぇ',  'wo' =>     'を',
                         'wyi' =>     'ゐ',                    'wye' =>     'ゑ',
       'sa' =>     'さ',  'si' =>     'し',  'su' =>     'す',  'se' =>     'せ',  'so' =>     'そ',
       'ya' =>     'や',  'yi' =>     'い',  'yu' =>     'ゆ',  'ye' =>   'いぇ',  'yo' =>     'よ',
        'a' =>     'あ',   'i' =>     'い',   'u' =>     'う',   'e' =>     'え',   'o' =>     'お',
        'n' =>     'ん',
        'm' =>     'ん',
    }.inject(text){|str,(rom,hir)| str.gsub(rom,hir) }
  end

end
